@page "/entries"

@using Steps.Shared.Contracts.Entries.ViewModels
@inherits Steps.Client.Features.Common.ManageBaseComponent<Entry, Steps.Shared.Contracts.Entries.ViewModels.EntryViewModel, Steps.Shared.Contracts.Entries.ViewModels.CreateEntryViewModel, Steps.Shared.Contracts.Entries.ViewModels.UpdateEntryViewModel>

<RadzenCard>
    <RadzenDataGrid TItem="EntryViewModel" Data="Manager.Data" AllowPaging="true"
                    PageSize="Manager.PageSize" EmptyText="Заявки еще не созданы"
                    IsLoading="@Manager.IsLoading" Count="@Manager.TotalCount"
                    LoadData="@OnChangePage"
                    RowSelect="@(e => DialogManager.ShowCardDialog(e))">

        <HeaderTemplate>
            @if (!IsReadonly)
            {
                <RadzenButton ButtonStyle="ButtonStyle.Primary" Icon="add_circle" Text="Создать заявку"
                              Click="@OnCreate"/>
            }
            <RadzenText Text="*Отображаются только ваши заявки"/>
        </HeaderTemplate>

        <Columns>
            <RadzenDataGridColumn TItem="EntryViewModel" Property="@nameof(EntryViewModel.Number)" Title="Номер"/>
            <RadzenDataGridColumn TItem="EntryViewModel" Property="@nameof(EntryViewModel.ContestName)" Title="Мероприятие"/>

            @if (!IsReadonly)
            {
                <RadzenDataGridColumn Width="16%" Context="c" Filterable="false" Sortable="false"
                                      TextAlign="TextAlign.Right" Frozen="true"
                                      FrozenPosition="FrozenColumnPosition.Right">
                    <Template Context="c">
                        <RadzenButton Icon="edit" ButtonStyle="ButtonStyle.Light" Variant="Variant.Flat"
                                      Size="ButtonSize.Medium" class="rz-my-1 rz-ms-1"
                                      Click="@(() => OnUpdate(c))" @onclick:stopPropagation="true"/>

                        <RadzenButton Icon="delete" ButtonStyle="ButtonStyle.Danger" Variant="Variant.Flat"
                                      Size="ButtonSize.Medium" Shade="Shade.Lighter" class="rz-my-1 rz-ms-1"
                                      Click="@(() => OnDelete(c))" @onclick:stopPropagation="true"/>
                    </Template>
                </RadzenDataGridColumn>
            }

        </Columns>
    </RadzenDataGrid>
</RadzenCard>